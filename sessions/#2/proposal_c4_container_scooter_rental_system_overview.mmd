C4Container
    title Container Diagram for e-scooter and e-bike rental

    Person(user, "User", "A MobiCorp user")

    Container_Boundary(c1, "MobiCorp Rental System") {
        Container(mobile, "Mobile App", "iOS/Android", "Provides booking functionality to users on mobile devices")
        Container(webserver, "Web Server", "API Gateway", "Handles API requests from mobile app, routes to services, authenticates user")
        Container(bookingService, "Booking Service", "Service", "Keeps track of booked vehicles")
        Container(locationService, "Location Service", "Service", "Keeps track of current vehicle locations, optimizes search for a nearby vehicle
        <br>Shows parking zones
        <br>Slows vehicles down in some areas
        <br>Shuts vehicle down outside of operating zone")
        Container(paymentService, "Payment Service", "Service", "Charges users, validates payment methods")
        Container(fleetService, "Fleet Service", "Service", "Receives updates from vehicles and publishes messages
        <br>Sends events back to vehicles (locking)")
    }

    Container_Boundary(c3, "Fleet") {
        Container(eScooter, "e-scooter")
        Container(eBike, "e-bike")
    }

    Container_Boundary(c2, "Messaging") {
        Container(messageBroker, "Message Broker")
    }

    Rel(user, mobile, "Uses", "HTTPS")
    Rel(mobile, webserver, "Makes API calls to", "HTTPS/JSON")
    Rel(webserver, paymentService, "Validates payment methods", "Internal API")
    Rel(webserver, locationService, "Fetches vehicle location", "Internal API")
    Rel(webserver, bookingService, "Reserves or books a vehicle, notifies about end of a ride", "Internal API")
    Rel(bookingService, locationService, "Notifies that a vehicle is unavailable (booked, reserved, in maintenance mode)", "Messaging API")

    Rel(eScooter, fleetService, "Notifies about current position, remaining charge")
    Rel(eBike, fleetService, "Notifies about current position, remaining charge")

    Rel(fleetService, messageBroker, "Published GPS events, battery status events")
    Rel(messageBroker, locationService, "Subscribes to vehicle location updates", "Pub/Sub")
