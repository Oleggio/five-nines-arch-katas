# Battery Replacement Process

## Overview

To improve vehicle utilization, increase user satisfaction, and match growing demand,
MobiCorp needs to replace batteries before they completely run out of charge or dispose of them when batteries reach the end of life.
When a battery has fallen below the threshold or its temperature rises above safe levels,
the system automatically prompts the user to finish their ride
and estimates battery condition using the in-house trained ML model.

## Container View

| Container Name                 | Functionality Overview                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|--------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Vertex AI with ML model        | Hosts an in-house trained ML model ([ADR-0003](../../../adrs/ADR-0003%20-%20Vertex%20AI%20as%20core%20platform%20for%20AI%20and%20GenAI.md)). This model is responsible for remaining useful lifetime (RUL) and state of health (SOH) predictions. It is important to avoid battery failures during ride, so they have to be replaced by new ones in due time.                                                                                                                                                                                                                                                                                                                                 |
| Vertex AI conversational model | Provides access to a conversational Gen AI model (proprietary or custom) ([ADR-0003](../../../adrs/ADR-0003%20-%20Vertex%20AI%20as%20core%20platform%20for%20AI%20and%20GenAI.md)). This model is retrieves current demand and based on the number of charged vehicles give members of the maintenance crew directions where to bring them.                                                                                                                                                                                                                                                                                                                                                    | 
| Fleet Service                  | Receives telemetry from vehicles. It is integrated with GCP IoT Platform via Pub/Sub. Vehicles on the other hand are integrated with GCP IoT platform via MQTT protocol ([ADR-0002](../../../adrs/ADR-0002%20-%20Vehicle%20telemetry%20&%20integration%20stack.md)). When it notices that a charge level has fallen below the threshold or a temperature has increased, it marks the vehicle as unavailable for booking and notifies the user to stop the ride due to low battery level. The user is not required to stop the ride immediately and can even continue using a completely discharged vehicle. The only restriction is 12 hours, after which the vehicle will be locked remotely. |
| Maintenance Service            | Records all maintenance requests. Then it chooses the next vehicle to maintain and notifies members of the maintenance crew riding around in a van where to go to locate the vehicle and where to move it to based on current demand.                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 
| Maintainer UI                  | Mobile app used by company staff to find the next vehicle to maintain and to record maintenance requests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

![Diagram](Battery%20Replacement%20and%20Fleet%20Allocation.drawio.png)
